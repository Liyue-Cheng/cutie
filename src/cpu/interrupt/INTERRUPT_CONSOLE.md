# ä¸­æ–­æ§åˆ¶å™¨è¿½è¸ªç³»ç»Ÿ

## ğŸ¯ åŠŸèƒ½

å®Œæ•´è¿½è¸ªæ‰€æœ‰ä¸­æ–­çš„å¤„ç†è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ï¼š

1. âœ… **ä¸­æ–­æ¥æ”¶**ï¼šè®°å½•æ‰€æœ‰è¿›å…¥ç³»ç»Ÿçš„ä¸­æ–­
2. âœ… **å»é‡æ£€æµ‹**ï¼šæ˜¾ç¤ºå“ªäº›ä¸­æ–­è¢«ä¸¢å¼ƒï¼ˆæœ¬æœºå·²å¤„ç†ï¼‰
3. âœ… **å¤„ç†å™¨åˆ†å‘**ï¼šè¿½è¸ªæ¯ä¸ªå¤„ç†å™¨çš„æ‰§è¡Œç»“æœ
4. âœ… **é”™è¯¯æ•è·**ï¼šè®°å½•æ‰€æœ‰å¤„ç†å™¨é”™è¯¯ï¼ˆsync/asyncï¼‰
5. âœ… **æ€§èƒ½ç›‘æ§**ï¼šæ¯ä¸ªå¤„ç†å™¨çš„æ‰§è¡Œæ—¶é—´
6. âœ… **ä¸­æ–­æ³¨å†Œ**ï¼šWB é˜¶æ®µæ³¨å†Œåˆ°ä¸­æ–­è¡¨
7. âœ… **è¡¨æ¸…ç†**ï¼šè¿‡æœŸæ¡ç›®æ¸…ç†

---

## ğŸ“Š Console è¾“å‡ºç¤ºä¾‹

### 1. ä¸­æ–­æ³¨å†Œï¼ˆWB é˜¶æ®µï¼‰

```
[ä¸­æ–­æ³¨å†Œ] 19:31:11 task.create è¡¨å¤§å°: 5
```

### 2. ä¸­æ–­æ¥æ”¶ï¼ˆSSEï¼‰

```
[ä¸­æ–­æ¥æ”¶] 19:31:12 task.created SSE
ğŸ“¥ ä¸­æ–­ä¿¡æ¯:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Event Type        â”‚ task.created                        â”‚
â”‚ Interrupt Type    â”‚ sse                                 â”‚
â”‚ Correlation ID    â”‚ corr_1760787071337_y_rcNrLVGc       â”‚
â”‚ Event ID          â”‚ evt_123456                          â”‚
â”‚ Timestamp         â”‚ 2025-10-18T11:31:12.000Z            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ“¦ Payload: { task_id: '...', ... }
```

### 3. ä¸­æ–­å»é‡ï¼ˆæœ¬æœºå·²å¤„ç†ï¼‰

```
[ä¸­æ–­å»é‡] 19:31:12 task.created 150mså‰å·²å¤„ç†
ğŸ”¥ å»é‡ä¿¡æ¯:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Event Type        â”‚ task.created                        â”‚
â”‚ Correlation ID    â”‚ corr_1760787071337_y_rcNrLVGc       â”‚
â”‚ Local Instruction â”‚ task.create                         â”‚
â”‚ Age (ms)          â”‚ 150                                 â”‚
â”‚ Action            â”‚ âœ–ï¸ ä¸¢å¼ƒï¼ˆæœ¬æœºå·²å¤„ç†ï¼‰                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. ä¸­æ–­å¤„ç†ï¼ˆæˆåŠŸï¼‰

```
[ä¸­æ–­å¤„ç†] 19:31:12 task.created 5ms âœ“
ğŸ“¤ åˆ†å‘ä¿¡æ¯:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Event Type         â”‚ task.created     â”‚
â”‚ Correlation ID     â”‚ N/A              â”‚
â”‚ Handler Count      â”‚ 2                â”‚
â”‚ Total Duration (ms)â”‚ 5                â”‚
â”‚ Status             â”‚ âœ“ å…¨éƒ¨æˆåŠŸ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ“‹ å¤„ç†å™¨ç»“æœ:
âœ“ Handler 1: handleTaskCreated (2ms)
âœ“ Handler 2: updateTaskList (3ms)
ğŸ“¦ Event Payload: { ... }
```

### 5. ä¸­æ–­å¤„ç†ï¼ˆéƒ¨åˆ†å¤±è´¥ï¼‰

```
[ä¸­æ–­å¤„ç†] 19:31:12 task.updated 8ms âš 
ğŸ“¤ åˆ†å‘ä¿¡æ¯:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Event Type         â”‚ task.updated     â”‚
â”‚ Correlation ID     â”‚ N/A              â”‚
â”‚ Handler Count      â”‚ 3                â”‚
â”‚ Total Duration (ms)â”‚ 8                â”‚
â”‚ Status             â”‚ âš  éƒ¨åˆ†å¤±è´¥        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ“‹ å¤„ç†å™¨ç»“æœ:
âœ“ Handler 1: handleTaskUpdate (2ms)
âœ– Handler 2: syncToBackend (5ms)
   Error: Network timeout
âœ“ Handler 3: notifyUser (1ms)
ğŸ“¦ Event Payload: { ... }
```

### 6. æ— å¤„ç†å™¨è­¦å‘Š

```
[ä¸­æ–­è­¦å‘Š] 19:31:12 unknown.event æ— å¤„ç†å™¨
âš ï¸ è­¦å‘Š:
æ²¡æœ‰ä¸ºäº‹ä»¶ç±»å‹ "unknown.event" æ³¨å†Œå¤„ç†å™¨
```

### 7. ä¸­æ–­è¡¨æ¸…ç†

```
[ä¸­æ–­æ¸…ç†] 19:31:15 æ¸…ç†äº† 3 ä¸ªè¿‡æœŸæ¡ç›® (10 â†’ 7)
```

---

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### æµè§ˆå™¨æ§åˆ¶å°

ä¸­æ–­æ§åˆ¶å°å·²è‡ªåŠ¨æš´éœ²åˆ°å…¨å±€ï¼š

```javascript
// å¯ç”¨/ç¦ç”¨è¿½è¸ª
interruptConsole.enable()
interruptConsole.disable()

// æ£€æŸ¥çŠ¶æ€
interruptConsole.isEnabled()

// æŸ¥çœ‹ä¸­æ–­è¡¨ç»Ÿè®¡
interruptHandler.getStats()
```

### ç¼–ç¨‹æ¥å£

```typescript
import { interruptConsole } from '@/cpu/interrupt/InterruptConsole'

// å¯ç”¨è¿½è¸ª
interruptConsole.enable()

// ç¦ç”¨è¿½è¸ª
interruptConsole.disable()
```

---

## ğŸ¨ é¢œè‰²è¯´æ˜

| é¢œè‰²    | å«ä¹‰                |
| ------- | ------------------- |
| ğŸ”µ è“è‰² | ä¸­æ–­æ¥æ”¶            |
| ğŸŸ¢ ç»¿è‰² | å¤„ç†æˆåŠŸ            |
| ğŸŸ¡ é»„è‰² | å»é‡ä¸¢å¼ƒ            |
| ğŸ”´ çº¢è‰² | å¤„ç†é”™è¯¯ / æ— å¤„ç†å™¨ |
| ğŸŸ£ ç´«è‰² | ä¸­æ–­æ³¨å†Œ            |
| ğŸ”· é›è“ | ä¸­æ–­æ¸…ç†            |

---

## ğŸ› è°ƒè¯•æŠ€å·§

### 1. æ£€æŸ¥ä¸­æ–­æ˜¯å¦è¢«å»é‡

å¦‚æœä½ çš„æ“ä½œæ²¡æœ‰è§¦å‘æ›´æ–°ï¼Œæ£€æŸ¥æ˜¯å¦è¢«å»é‡ï¼š

```javascript
// æŸ¥çœ‹ä¸­æ–­è¡¨
interruptHandler.getStats()
```

å¦‚æœçœ‹åˆ°å¯¹åº”çš„ `correlationId`ï¼Œè¯´æ˜è¢«è¯†åˆ«ä¸ºæœ¬æœºæ“ä½œè€Œä¸¢å¼ƒã€‚

### 2. æ£€æŸ¥å¤„ç†å™¨æ˜¯å¦æ³¨å†Œ

å¦‚æœçœ‹åˆ° "æ— å¤„ç†å™¨" è­¦å‘Šï¼š

```typescript
// ç¡®ä¿åœ¨åˆå§‹åŒ–æ—¶æ³¨å†Œäº†å¤„ç†å™¨
interruptHandler.on('task.created', handleTaskCreated)
```

### 3. è¿½è¸ªå¼‚æ­¥é”™è¯¯

å¼‚æ­¥å¤„ç†å™¨çš„é”™è¯¯ä¼šè¢«è‡ªåŠ¨æ•è·å¹¶æ˜¾ç¤ºï¼š

```
âœ– Handler 2: asyncHandler (10ms)
   Error: Failed to fetch
```

### 4. æ€§èƒ½åˆ†æ

æŸ¥çœ‹æ¯ä¸ªå¤„ç†å™¨çš„æ‰§è¡Œæ—¶é—´ï¼š

```
âœ“ Handler 1: fastHandler (1ms)
âœ“ Handler 2: slowHandler (50ms)  â† å¯èƒ½éœ€è¦ä¼˜åŒ–
```

---

## ğŸ“ ä¸ CPUConsole çš„å¯¹æ¯”

| ç‰¹æ€§       | CPUConsole    | InterruptConsole |
| ---------- | ------------- | ---------------- |
| è¿½è¸ªå¯¹è±¡   | Pipeline æŒ‡ä»¤ | SSE ä¸­æ–­         |
| åˆ›å»ºäº‹ä»¶   | âœ…            | âœ…               |
| æˆåŠŸ/å¤±è´¥  | âœ…            | âœ…               |
| å»é‡æ£€æµ‹   | âŒ            | âœ…               |
| å¤„ç†å™¨è¿½è¸ª | âŒ            | âœ…               |
| æ€§èƒ½ç›‘æ§   | âœ…            | âœ…               |
| å½©è‰²è¾“å‡º   | âœ…            | âœ…               |
| å¯æŠ˜å      | âœ…            | âœ…               |

---

## ğŸ”§ é…ç½®

### æŒä¹…åŒ–è®¾ç½®

ä¸­æ–­æ§åˆ¶å°çš„å¯ç”¨/ç¦ç”¨çŠ¶æ€ä¼šä¿å­˜åˆ° `localStorage`ï¼š

- Key: `interrupt-console-enabled`
- Value: `'true'` | `'false'`

### é»˜è®¤çŠ¶æ€

é»˜è®¤**å¯ç”¨**ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¦ç”¨ï¼š

```javascript
interruptConsole.disable()
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

1. âœ… å®Œæ•´çš„è¿½è¸ªç³»ç»Ÿ
2. âœ… æ‰€æœ‰å¤„ç†å™¨æŠ¥å‘Šç»“æœ
3. âœ… å½©è‰²è¾“å‡ºå’Œå¯æŠ˜å 
4. âœ… å»é‡æ£€æµ‹å¯è§†åŒ–
5. â³ æ·»åŠ æ€§èƒ½ç»Ÿè®¡é¢æ¿
6. â³ æ·»åŠ ä¸­æ–­å†å²è®°å½•
7. â³ æ·»åŠ è¿‡æ»¤å™¨ï¼ˆæŒ‰äº‹ä»¶ç±»å‹ï¼‰

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [CPU Pipeline](../Pipeline.ts)
- [CPUConsole](../logging/CPUConsole.ts)
- [ä¸­æ–­å¤„ç†å™¨è®¾è®¡](./README.md)
