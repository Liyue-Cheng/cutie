# Cutie æ‹–æ”¾é€»è¾‘è§„èŒƒ

## ğŸ“‹ ç›®å½•

- [è§†å›¾ç±»å‹æ¦‚è¿°](#è§†å›¾ç±»å‹æ¦‚è¿°)
- [è§†å›¾é—´æ‹–æ‹½è§„åˆ™](#è§†å›¾é—´æ‹–æ‹½è§„åˆ™)
- [æ—¥å†è§†å›¾äº¤äº’](#æ—¥å†è§†å›¾äº¤äº’)
- [ä»»åŠ¡æ’åºè§„åˆ™](#ä»»åŠ¡æ’åºè§„åˆ™)

> **Context Key è§„èŒƒ**ï¼šè¯¦è§ [VIEW_CONTEXT_KEY_SPEC.md](../references/VIEW_CONTEXT_KEY_SPEC.md)

---

## è§†å›¾ç±»å‹æ¦‚è¿°

### è§†å›¾åˆ†ç±»

æ ¹æ®æ—¶é—´è¯­ä¹‰ï¼Œè§†å›¾å¯åˆ†ä¸ºä»¥ä¸‹ç±»å‹ï¼š

| åˆ†ç±»         | Context Key å‰ç¼€   | æ—¶é—´è¯­ä¹‰     | ç¤ºä¾‹                          |
| ------------ | ------------------ | ------------ | ----------------------------- |
| **æš‚å­˜è§†å›¾** | `misc::staging`    | æ— æ—¶é—´çº¦æŸ   | `misc::staging`, `misc::staging::no-area` |
| **è¿‡å»è§†å›¾** | `daily::{date}`    | æ—¥æœŸ < ä»Šå¤©  | `daily::2025-10-01`ï¼ˆå‡è®¾ä»Šå¤©æ˜¯ 10-05ï¼‰ |
| **ä»Šæ—¥è§†å›¾** | `daily::{date}`    | æ—¥æœŸ = ä»Šå¤©  | `daily::2025-10-05`           |
| **æœªæ¥è§†å›¾** | `daily::{date}`    | æ—¥æœŸ > ä»Šå¤©  | `daily::2025-10-10`           |
| **é€šç”¨è§†å›¾** | `area::*`, `project::*`, `upcoming::*` | æ— ç‰¹å®šæ—¥æœŸ | `area::{uuid}`, `project::{uuid}` |

### æ—¶é—´è¯­ä¹‰åˆ¤æ–­

```typescript
function getTimeSemantics(contextKey: string, today: string): 'staging' | 'past' | 'today' | 'future' | 'generic' {
  if (contextKey.startsWith('misc::staging')) return 'staging'
  if (contextKey.startsWith('daily::')) {
    const date = contextKey.split('::')[1]
    if (date < today) return 'past'
    if (date === today) return 'today'
    return 'future'
  }
  return 'generic'
}
```

---

## è§†å›¾é—´æ‹–æ‹½è§„åˆ™

### 1ï¸âƒ£ åŒä¸€è§†å›¾å†…æ‹–åŠ¨

**è¡Œä¸º**ï¼šä»…è°ƒæ•´ä»»åŠ¡æ’åºï¼Œä¸è§¦å‘ä¸šåŠ¡é€»è¾‘

**é€‚ç”¨èŒƒå›´**ï¼šæ‰€æœ‰è§†å›¾ç±»å‹

---

### 2ï¸âƒ£ æš‚å­˜è§†å›¾ â†’ æ—¥æœŸè§†å›¾

| ç›®æ ‡è§†å›¾     | è¡Œä¸º | ä¸šåŠ¡äº‹ä»¶                   |
| ------------ | ---- | -------------------------- |
| è¿‡å»æ—¥æœŸè§†å›¾ | å…è®¸ | åˆ›å»ºæ—¥ç¨‹ + è‡ªåŠ¨æ ‡è®°å®Œæˆ âœ… |
| ä»Šæ—¥è§†å›¾     | å…è®¸ | ã€åˆ›å»ºæ—¥ç¨‹äº‹ä»¶ã€‘           |
| æœªæ¥æ—¥æœŸè§†å›¾ | å…è®¸ | ã€åˆ›å»ºæ—¥ç¨‹äº‹ä»¶ã€‘           |

**å¿ƒæ™ºæ¨¡å‹**ï¼šæ’æœŸ

**æºè§†å›¾èŒƒå›´**ï¼š
- `misc::staging`
- `misc::staging::no-area`
- `misc::staging::{area_uuid}`

**è¿‡å»æ—¥æœŸå¤„ç†**ï¼š

- åˆ›å»ºè¯¥æ—¥æœŸçš„ scheduleï¼ˆ`outcome = COMPLETED_ON_DAY`ï¼‰
- è®¾ç½® `tasks.completed_at = è¿‡å»æ—¥æœŸ`
- ç”¨é€”ï¼šè¡¥å½•å†å²å®Œæˆçš„ä»»åŠ¡

---

### 3ï¸âƒ£ æ—¥æœŸè§†å›¾ â†’ æš‚å­˜è§†å›¾

**å¿ƒæ™ºæ¨¡å‹**ï¼šå–æ¶ˆæ’æœŸ

**è¡Œä¸º**ï¼šè§¦å‘ã€å›åˆ°æš‚å­˜åŒºäº‹ä»¶ã€‘

**å·²å®Œæˆä»»åŠ¡å¤„ç†**ï¼š

- å…è®¸æ‹–å›æš‚å­˜è§†å›¾
- è‡ªåŠ¨é‡å¼€ä»»åŠ¡ï¼ˆ`SET completed_at = NULL`ï¼‰
- åˆ é™¤ä»Šæ—¥åŠæœªæ¥çš„ schedule å’Œ time_block

---

### 4ï¸âƒ£ æ—¥æœŸè§†å›¾ â†’ æ—¥æœŸè§†å›¾ï¼ˆæ”¹æœŸï¼‰

**å¿ƒæ™ºæ¨¡å‹**ï¼šè°ƒæ•´æ’æœŸæ—¥æœŸ

#### åœºæ™¯è¯¦è§£

---

##### åœºæ™¯ç»„ 1ï¼šè¿‡å» â†’ ä»Šæ—¥/æœªæ¥

###### æƒ…å†µ 1.1ï¼šå·²å®Œæˆä»»åŠ¡

**ç”¨æˆ·æ„å›¾**ï¼šä»»åŠ¡è™½ç„¶è¿‡å»å®Œæˆäº†ï¼Œä½†åˆæƒ³é‡åš

**æ¡ä»¶åˆ¤æ–­**ï¼š

- æºï¼šè¿‡å»æ—¥æœŸè§†å›¾
- ç›®æ ‡ï¼šä»Šæ—¥æˆ–æœªæ¥æ—¥æœŸè§†å›¾
- ä»»åŠ¡çŠ¶æ€ï¼štasks.completed_at æœ‰å€¼
- schedule.outcomeï¼šCOMPLETED_ON_DAY

**æ‰§è¡Œé€»è¾‘**ï¼š

1. è‡ªåŠ¨é‡å¼€ä»»åŠ¡ï¼š`SET tasks.completed_at = NULL`
2. ä¿ç•™æº scheduleï¼ˆè®°å½•å†å²å®Œæˆï¼‰
3. åˆ›å»ºç›®æ ‡ scheduleï¼š`outcome = PLANNED`
4. æç¤ºç”¨æˆ·ï¼š"è¯¥ä»»åŠ¡å·²å®Œæˆï¼Œæ‹–åˆ°æ–°æ—¥æœŸå°†é‡å¼€ä»»åŠ¡"

**æ•°æ®ç¤ºä¾‹**ï¼š

```
æºè§†å›¾: daily::2025-10-01
ç›®æ ‡è§†å›¾: daily::2025-10-10

10-01: schedule.outcome = COMPLETED_ON_DAYï¼ˆä¿ç•™ï¼‰
10-10: schedule.outcome = PLANNEDï¼ˆæ–°å»ºï¼‰
tasks.completed_at = NULLï¼ˆé‡å¼€ï¼‰
```

**å¿ƒæ™ºæ¨¡å‹**ï¼š"è¿™ä¸ªä»»åŠ¡æˆ‘ä»¥å‰åšè¿‡ï¼Œç°åœ¨æƒ³å†åšä¸€æ¬¡"

---

###### æƒ…å†µ 1.2ï¼šæœªå®Œæˆä»»åŠ¡

**ç”¨æˆ·æ„å›¾**ï¼šè¿‡å»è®¡åˆ’ä½†æ²¡åšå®Œï¼Œç°åœ¨æƒ³ç»§ç»­åš

**æ¡ä»¶åˆ¤æ–­**ï¼š

- æºï¼šè¿‡å»æ—¥æœŸè§†å›¾
- ç›®æ ‡ï¼šä»Šæ—¥æˆ–æœªæ¥æ—¥æœŸè§†å›¾
- ä»»åŠ¡çŠ¶æ€ï¼štasks.completed_at IS NULL
- schedule.outcomeï¼šPLANNED æˆ– PRESENCE_LOGGED

**æ‰§è¡Œé€»è¾‘**ï¼š

1. ä¿ç•™æº scheduleï¼ˆè®°å½•è¿‡å»çš„è®¡åˆ’/å·¥ä½œï¼‰
2. åˆ›å»ºç›®æ ‡ scheduleï¼š`outcome = PLANNED`
3. ä»»åŠ¡çŠ¶æ€ä¸å˜ï¼ˆæœ¬æ¥å°±æ˜¯æœªå®Œæˆï¼‰

**æ•°æ®ç¤ºä¾‹**ï¼š

```
æºè§†å›¾: daily::2025-10-01
ç›®æ ‡è§†å›¾: daily::2025-10-10

10-01: schedule.outcome = PRESENCE_LOGGEDï¼ˆä¿ç•™ï¼Œè®°å½•æ›¾ç»åšè¿‡ï¼‰
10-10: schedule.outcome = PLANNEDï¼ˆæ–°å»ºï¼‰
tasks.completed_at = NULLï¼ˆä¿æŒæœªå®Œæˆï¼‰
```

**å¿ƒæ™ºæ¨¡å‹**ï¼š"è¿™ä¸ªä»»åŠ¡æ‹–äº†å¾ˆä¹…ï¼Œç°åœ¨é‡æ–°å®‰æ’æ—¶é—´åš"

---

##### åœºæ™¯ç»„ 2ï¼šä»Šæ—¥ â†’ æœªæ¥

###### æƒ…å†µ 2.1ï¼šæœªå®Œæˆ + æœªç‚¹è¿‡ä»»ä½•æŒ‰é’®

**ç”¨æˆ·æ„å›¾**ï¼šä»Šå¤©æ²¡æ—¶é—´åšï¼Œæ¨è¿Ÿåˆ°æœªæ¥

**æ¡ä»¶åˆ¤æ–­**ï¼š

- æºï¼šä»Šæ—¥è§†å›¾
- ç›®æ ‡ï¼šæœªæ¥æ—¥æœŸè§†å›¾
- ä»»åŠ¡çŠ¶æ€ï¼šæœªå®Œæˆ
- schedule.outcomeï¼šPLANNEDï¼ˆæœªç‚¹è¿‡"åœ¨åœº"æˆ–"å®Œæˆ"ï¼‰

**æ‰§è¡Œé€»è¾‘**ï¼š

1. **åˆ é™¤**ä»Šæ—¥ scheduleï¼ˆä»…ä»…æ˜¯è®¡åˆ’ï¼Œæ²¡æœ‰å®é™…å·¥ä½œï¼‰
2. åˆ é™¤ä»Šæ—¥æ‰€æœ‰ time_blockï¼ˆå¦‚æœæœ‰ï¼‰
3. åˆ›å»ºæœªæ¥ scheduleï¼š`outcome = PLANNED`

**æ•°æ®ç¤ºä¾‹**ï¼š

```
æºè§†å›¾: daily::2025-10-06ï¼ˆä»Šæ—¥ï¼‰
ç›®æ ‡è§†å›¾: daily::2025-10-10

10-06: schedule è¢«åˆ é™¤
10-10: schedule.outcome = PLANNEDï¼ˆæ–°å»ºï¼‰
```

**å¿ƒæ™ºæ¨¡å‹**ï¼š"ä»Šå¤©åªæ˜¯è®¡åˆ’åšä½†æ²¡åšï¼Œæ”¹æœŸåˆ°æœªæ¥ï¼Œä¸ç•™è®°å½•"

**å…³é”®è®¾è®¡**ï¼šè½»é‡æ”¹æœŸï¼Œä¸ä¿ç•™æ— æ„ä¹‰çš„ PLANNED è®°å½•

---

###### æƒ…å†µ 2.2ï¼šæœªå®Œæˆ + ç‚¹è¿‡"åœ¨åœº"

**ç”¨æˆ·æ„å›¾**ï¼šä»Šå¤©åšäº†ä¸€éƒ¨åˆ†ä½†æ²¡å®Œæˆï¼Œæœªæ¥ç»§ç»­åš

**æ¡ä»¶åˆ¤æ–­**ï¼š

- æºï¼šä»Šæ—¥è§†å›¾
- ç›®æ ‡ï¼šæœªæ¥æ—¥æœŸè§†å›¾
- ä»»åŠ¡çŠ¶æ€ï¼šæœªå®Œæˆ
- schedule.outcomeï¼šPRESENCE_LOGGED

**æ‰§è¡Œé€»è¾‘**ï¼š

1. **ä¿ç•™**ä»Šæ—¥ scheduleï¼ˆè®°å½•ä»Šå¤©çš„å®é™…å·¥ä½œï¼‰
2. ä¿ç•™ä»Šæ—¥æ‰€æœ‰ time_blockï¼ˆè®°å½•å·¥ä½œæ—¶æ®µï¼‰
3. åˆ›å»ºæœªæ¥ scheduleï¼š`outcome = PLANNED`

**æ•°æ®ç¤ºä¾‹**ï¼š

```
æºè§†å›¾: daily::2025-10-06ï¼ˆä»Šæ—¥ï¼‰
ç›®æ ‡è§†å›¾: daily::2025-10-10

10-06: schedule.outcome = PRESENCE_LOGGEDï¼ˆä¿ç•™ï¼‰
       + time_block: 14:00-16:00ï¼ˆä¿ç•™ï¼‰
10-10: schedule.outcome = PLANNEDï¼ˆæ–°å»ºï¼‰
```

**å¿ƒæ™ºæ¨¡å‹**ï¼š"ä»Šå¤©ç¡®å®åšäº†è¿™ä¸ªä»»åŠ¡ï¼Œè™½ç„¶æ²¡å®Œæˆï¼Œä½†å·¥ä½œè®°å½•è¦ä¿ç•™"

**å…³é”®è®¾è®¡**ï¼šåŒºåˆ†"ä»…è®¡åˆ’"å’Œ"å®é™…å·¥ä½œ"ï¼Œåè€…å¿…é¡»ä¿ç•™å†å²

---

###### æƒ…å†µ 2.3ï¼šå·²å®Œæˆä»»åŠ¡

**ç”¨æˆ·æ„å›¾**ï¼šä»Šå¤©å®Œæˆäº†ï¼Œä½†åˆæƒ³æœªæ¥ç»§ç»­åšï¼ˆé‡åšæˆ–è¿­ä»£ï¼‰

**æ¡ä»¶åˆ¤æ–­**ï¼š

- æºï¼šä»Šæ—¥è§†å›¾
- ç›®æ ‡ï¼šæœªæ¥æ—¥æœŸè§†å›¾
- ä»»åŠ¡çŠ¶æ€ï¼štasks.completed_at æœ‰å€¼ï¼ˆä»Šå¤©å®Œæˆï¼‰
- schedule.outcomeï¼šCOMPLETED_ON_DAY

**æ‰§è¡Œé€»è¾‘**ï¼š

1. è‡ªåŠ¨é‡å¼€ä»»åŠ¡ï¼š`SET tasks.completed_at = NULL`
2. **ä¿ç•™**ä»Šæ—¥ scheduleï¼ˆè®°å½•å†å²å®Œæˆï¼‰
3. ä¿ç•™ä»Šæ—¥æ‰€æœ‰ time_block
4. åˆ›å»ºæœªæ¥ scheduleï¼š`outcome = PLANNED`
5. æç¤ºç”¨æˆ·ï¼š"è¯¥ä»»åŠ¡å·²å®Œæˆï¼Œæ‹–åˆ°æ–°æ—¥æœŸå°†é‡å¼€ä»»åŠ¡"

**æ•°æ®ç¤ºä¾‹**ï¼š

```
æºè§†å›¾: daily::2025-10-06ï¼ˆä»Šæ—¥ï¼‰
ç›®æ ‡è§†å›¾: daily::2025-10-10

10-06: schedule.outcome = COMPLETED_ON_DAYï¼ˆä¿ç•™ï¼‰
10-10: schedule.outcome = PLANNEDï¼ˆæ–°å»ºï¼‰
tasks.completed_at = NULLï¼ˆé‡å¼€ï¼‰
```

**å¿ƒæ™ºæ¨¡å‹**ï¼š"è¿™ä¸ªä»»åŠ¡ä»Šå¤©å®Œæˆäº†ï¼Œä½†æˆ‘æœªæ¥è¿˜æƒ³å†åšä¸€æ¬¡"

---

##### åœºæ™¯ç»„ 3ï¼šä»Šæ—¥ â†’ è¿‡å» **ï¼ˆæ‹’ç»æ“ä½œï¼‰** âœ…

**ç”¨æˆ·æ„å›¾**ï¼šè¡¥å½•å†å²ï¼Ÿè¯¯æ“ä½œï¼Ÿ

**æ¡ä»¶åˆ¤æ–­**ï¼š

- æºï¼šä»Šæ—¥è§†å›¾
- ç›®æ ‡ï¼šè¿‡å»æ—¥æœŸè§†å›¾
- ä»»åŠ¡çŠ¶æ€ï¼šä»»æ„

**å†³ç­–**ï¼š**æ‹’ç»æ“ä½œï¼ˆé™é»˜å¼¹å›ï¼‰**

**æ‰§è¡Œé€»è¾‘**ï¼š

- æ‹–æ‹½è¢«æ‹’ç»ï¼Œä»»åŠ¡å¼¹å›åŸä½ç½®
- ä¸å¼¹å‡ºæç¤ºä¿¡æ¯ï¼ˆé™é»˜å¤„ç†ï¼‰
- ä¸ä¿®æ”¹ä»»ä½•æ•°æ®

**è®¾è®¡ç†ç”±**ï¼š

- è¿åæ—¶é—´çº¿é€»è¾‘ï¼ˆä¸èƒ½å°†ä»Šå¤©çš„ä»»åŠ¡æ”¹æœŸåˆ°è¿‡å»ï¼‰
- è¡¥å½•åº”è¯¥é€šè¿‡"è¿‡å»è§†å›¾çš„å®ŒæˆæŒ‰é’®"
- æ‹–æ‹½è¡¨ç¤º"æ”¹æœŸ"ï¼Œæ‹–åˆ°è¿‡å»è¿åæ”¹æœŸè¯­ä¹‰
- é™é»˜æ‹’ç»é¿å…æ‰“æ–­ç”¨æˆ·æ“ä½œæµ

**å¿ƒæ™ºæ¨¡å‹**ï¼šä¸é€‚ç”¨ï¼ˆæ“ä½œæœ¬èº«è¿åé€»è¾‘ï¼‰

---

##### åœºæ™¯ç»„ 4ï¼šæœªæ¥ â†’ ä»Šæ—¥

###### æƒ…å†µ 4.1ï¼šä»»æ„çŠ¶æ€

**ç”¨æˆ·æ„å›¾**ï¼šåŸè®¡åˆ’æœªæ¥åšï¼Œæå‰åˆ°ä»Šå¤©åš

**æ¡ä»¶åˆ¤æ–­**ï¼š

- æºï¼šæœªæ¥æ—¥æœŸè§†å›¾
- ç›®æ ‡ï¼šä»Šæ—¥è§†å›¾
- ä»»åŠ¡çŠ¶æ€ï¼šä»»æ„ï¼ˆé€šå¸¸æ˜¯æœªå®Œæˆï¼‰
- schedule.outcomeï¼šPLANNED

**æ‰§è¡Œé€»è¾‘**ï¼š

1. **åˆ é™¤**æœªæ¥ scheduleï¼ˆæœªæ¥çš„è®¡åˆ’ä½œåºŸï¼‰
2. åˆ é™¤æœªæ¥æ‰€æœ‰ time_blockï¼ˆå¦‚æœæœ‰ï¼‰
3. åˆ›å»ºä»Šæ—¥ scheduleï¼š`outcome = PLANNED`

**æ•°æ®ç¤ºä¾‹**ï¼š

```
æºè§†å›¾: daily::2025-10-10ï¼ˆæœªæ¥ï¼‰
ç›®æ ‡è§†å›¾: daily::2025-10-06ï¼ˆä»Šæ—¥ï¼‰

10-10: schedule è¢«åˆ é™¤
10-06: schedule.outcome = PLANNEDï¼ˆæ–°å»ºï¼‰
```

**å¿ƒæ™ºæ¨¡å‹**ï¼š"åŸæœ¬è®¡åˆ’æœªæ¥åšï¼Œç°åœ¨æœ‰æ—¶é—´äº†ï¼Œæå‰åˆ°ä»Šå¤©"

**å…³é”®è®¾è®¡**ï¼šæ ‡å‡†æ”¹æœŸï¼Œåˆ é™¤æºæ—¥ç¨‹ï¼Œåˆ›å»ºæ–°æ—¥ç¨‹

---

##### åœºæ™¯ç»„ 5ï¼šæœªæ¥ â†’ è¿‡å» **ï¼ˆæ‹’ç»æ“ä½œï¼‰** âœ…

**ç”¨æˆ·æ„å›¾**ï¼šè¡¥å½•è¿‡å»ï¼Ÿè¯¯æ“ä½œï¼Ÿ

**æ¡ä»¶åˆ¤æ–­**ï¼š

- æºï¼šæœªæ¥æ—¥æœŸè§†å›¾
- ç›®æ ‡ï¼šè¿‡å»æ—¥æœŸè§†å›¾
- ä»»åŠ¡çŠ¶æ€ï¼šä»»æ„

**å†³ç­–**ï¼š**æ‹’ç»æ“ä½œï¼ˆé™é»˜å¼¹å›ï¼‰**

**æ‰§è¡Œé€»è¾‘**ï¼š

- æ‹–æ‹½è¢«æ‹’ç»ï¼Œä»»åŠ¡å¼¹å›åŸä½ç½®
- ä¸å¼¹å‡ºæç¤ºä¿¡æ¯ï¼ˆé™é»˜å¤„ç†ï¼‰
- ä¸ä¿®æ”¹ä»»ä½•æ•°æ®

**è®¾è®¡ç†ç”±**ï¼š

- è¿åæ—¶é—´çº¿é€»è¾‘ï¼ˆä¸èƒ½å°†æœªæ¥çš„ä»»åŠ¡æ”¹æœŸåˆ°è¿‡å»ï¼‰
- ä¸åœºæ™¯ç»„ 3 ä¸€è‡´ï¼Œä¿æŒæ‹–æ‹½è¯­ä¹‰çš„ä¸€è‡´æ€§
- è¡¥å½•åº”è¯¥é€šè¿‡ä¸“é—¨çš„è¡¥å½•åŠŸèƒ½
- é™é»˜æ‹’ç»é¿å…æ‰“æ–­ç”¨æˆ·æ“ä½œæµ

**å¿ƒæ™ºæ¨¡å‹**ï¼šä¸é€‚ç”¨ï¼ˆæ“ä½œæœ¬èº«è¿åé€»è¾‘ï¼‰

---

##### åœºæ™¯ç»„ 6ï¼šæœªæ¥ â†’ æœªæ¥

###### æƒ…å†µ 6.1ï¼šä»»æ„çŠ¶æ€

**ç”¨æˆ·æ„å›¾**ï¼šè°ƒæ•´æœªæ¥çš„æ’æœŸæ—¥æœŸ

**æ¡ä»¶åˆ¤æ–­**ï¼š

- æºï¼šæœªæ¥æ—¥æœŸè§†å›¾ï¼ˆæ—¥æœŸ Aï¼‰
- ç›®æ ‡ï¼šæœªæ¥æ—¥æœŸè§†å›¾ï¼ˆæ—¥æœŸ Bï¼‰
- ä»»åŠ¡çŠ¶æ€ï¼šä»»æ„ï¼ˆé€šå¸¸æ˜¯æœªå®Œæˆï¼‰
- schedule.outcomeï¼šPLANNED

**æ‰§è¡Œé€»è¾‘**ï¼š

1. **åˆ é™¤**æºæ—¥æœŸ scheduleï¼ˆè®¡åˆ’ä½œåºŸï¼‰
2. åˆ é™¤æºæ—¥æœŸæ‰€æœ‰ time_blockï¼ˆå¦‚æœæœ‰ï¼‰
3. åˆ›å»ºç›®æ ‡æ—¥æœŸ scheduleï¼š`outcome = PLANNED`

**æ•°æ®ç¤ºä¾‹**ï¼š

```
æºè§†å›¾: daily::2025-10-10
ç›®æ ‡è§†å›¾: daily::2025-10-15

10-10: schedule è¢«åˆ é™¤
10-15: schedule.outcome = PLANNEDï¼ˆæ–°å»ºï¼‰
```

**å¿ƒæ™ºæ¨¡å‹**ï¼š"è¿œæœŸè§„åˆ’è°ƒæ•´ï¼Œä»ä¸€ä¸ªæœªæ¥æ—¥æœŸæ”¹åˆ°å¦ä¸€ä¸ªæœªæ¥æ—¥æœŸ"

**å…³é”®è®¾è®¡**ï¼šæ ‡å‡†æ”¹æœŸï¼Œæœªæ¥æ—¥æœŸä¹‹é—´çš„è°ƒæ•´æœ€å¸¸è§

---

### 5ï¸âƒ£ é€šç”¨è§†å›¾çš„æ‹–æ‹½è§„åˆ™

#### Area è§†å›¾ (`area::{uuid}`)

**æ‹–å…¥è§„åˆ™**ï¼š
- ä»ä»»æ„è§†å›¾æ‹–å…¥ â†’ è®¾ç½®ä»»åŠ¡çš„ `area_id`
- ä¸æ”¹å˜ä»»åŠ¡çš„æ’æœŸçŠ¶æ€

**æ‹–å‡ºè§„åˆ™**ï¼š
- æ‹–åˆ°æ—¥æœŸè§†å›¾ â†’ åˆ›å»ºæ’æœŸï¼ˆä¿ç•™ area_idï¼‰
- æ‹–åˆ°æš‚å­˜è§†å›¾ â†’ è§¦å‘ã€å›åˆ°æš‚å­˜åŒºäº‹ä»¶ã€‘ï¼ˆä¿ç•™ area_idï¼‰

#### Project è§†å›¾ (`project::{uuid}`)

**æ‹–å…¥è§„åˆ™**ï¼š
- ä»ä»»æ„è§†å›¾æ‹–å…¥ â†’ è®¾ç½®ä»»åŠ¡çš„ `project_id`
- æ‹–å…¥ç« èŠ‚è§†å›¾ (`project::{uuid}::section::{sectionId}`) â†’ åŒæ—¶è®¾ç½® `section_id`

**æ‹–å‡ºè§„åˆ™**ï¼š
- æ‹–åˆ°æ—¥æœŸè§†å›¾ â†’ åˆ›å»ºæ’æœŸï¼ˆä¿ç•™ project_idï¼‰
- æ‹–åˆ°æš‚å­˜è§†å›¾ â†’ è§¦å‘ã€å›åˆ°æš‚å­˜åŒºäº‹ä»¶ã€‘ï¼ˆä¿ç•™ project_idï¼‰

#### Upcoming è§†å›¾ (`upcoming::{timeRange}::{taskType}`)

**æ‹–å…¥è§„åˆ™**ï¼š
- âŒ ä¸æ”¯æŒç›´æ¥æ‹–å…¥ï¼ˆUpcoming æ˜¯è®¡ç®—ç”Ÿæˆçš„è§†å›¾ï¼‰

**æ‹–å‡ºè§„åˆ™**ï¼š
- æ‹–åˆ°æ—¥æœŸè§†å›¾ â†’ åˆ›å»º/ä¿®æ”¹æ’æœŸ
- æ‹–åˆ°æš‚å­˜è§†å›¾ â†’ è§¦å‘ã€å›åˆ°æš‚å­˜åŒºäº‹ä»¶ã€‘

---

### åœºæ™¯æ±‡æ€»è¡¨

| åœºæ™¯ç»„                  | æƒ…å†µ | ä»»åŠ¡çŠ¶æ€ | åœ¨åœºæ ‡è®° | æ“ä½œ            | å¿ƒæ™ºæ¨¡å‹           |
| ----------------------- | ---- | -------- | -------- | --------------- | ------------------ |
| **1. è¿‡å» â†’ ä»Šæ—¥/æœªæ¥** | 1.1  | å·²å®Œæˆ   | -        | é‡å¼€+åˆ›å»ºæ–°æ—¥ç¨‹ | é‡åšå·²å®Œæˆçš„ä»»åŠ¡   |
|                         | 1.2  | æœªå®Œæˆ   | -        | ä¿ç•™+åˆ›å»ºæ–°æ—¥ç¨‹ | ç»§ç»­æ‹–å»¶çš„ä»»åŠ¡     |
| **2. ä»Šæ—¥ â†’ æœªæ¥**      | 2.1  | æœªå®Œæˆ   | âŒ æœªç‚¹  | åˆ é™¤+æ”¹æœŸ       | è½»é‡æ¨è¿Ÿï¼ˆæ— å·¥ä½œï¼‰ |
|                         | 2.2  | æœªå®Œæˆ   | âœ… å·²ç‚¹  | ä¿ç•™+æ”¹æœŸ       | ä¿ç•™å·¥ä½œè®°å½•       |
|                         | 2.3  | å·²å®Œæˆ   | -        | é‡å¼€+åˆ›å»ºæ–°æ—¥ç¨‹ | é‡åšä»Šæ—¥å®Œæˆçš„     |
| **3. ä»Šæ—¥ â†’ è¿‡å»**      | -    | ä»»æ„     | -        | **æ‹’ç»**        | âŒ è¿åé€»è¾‘        |
| **4. æœªæ¥ â†’ ä»Šæ—¥**      | 4.1  | ä»»æ„     | -        | åˆ é™¤+æ”¹æœŸ       | æå‰æ‰§è¡Œ           |
| **5. æœªæ¥ â†’ è¿‡å»**      | -    | ä»»æ„     | -        | **æ‹’ç»**        | âŒ è¿åé€»è¾‘        |
| **6. æœªæ¥ â†’ æœªæ¥**      | 6.1  | ä»»æ„     | -        | åˆ é™¤+æ”¹æœŸ       | è¿œæœŸè§„åˆ’è°ƒæ•´       |

---

## æ—¥å†è§†å›¾äº¤äº’

### å…è®¸çš„æ“ä½œ

- âœ… åœ¨æ—¥å†ä¸Šç›´æ¥æ‹–æ‹½åˆ›å»ºæ—¶é—´å—
- âœ… ä»ä»»åŠ¡åˆ—è¡¨æ‹–æ‹½ä»»åŠ¡åˆ°æ—¥å†ï¼ˆåˆ›å»ºæ—¶é—´å—ï¼‰
- âœ… åœ¨æ—¥å†å†…æ‹–æ‹½è°ƒæ•´æ—¶é—´å—çš„æ—¶é•¿
- âœ… åœ¨æ—¥å†å†…æ‹–æ‹½ç§»åŠ¨æ—¶é—´å—çš„æ—¶é—´

### ç¦æ­¢çš„æ“ä½œ

- âŒ ä»æ—¥å†æ‹–æ‹½ä»»åŠ¡åˆ°ä»»åŠ¡åˆ—è¡¨ï¼ˆä¸ºäº†ç®€åŒ–é€»è¾‘ï¼‰
- âŒ ä»æ—¥å†æ‹–æ‹½ä»»åŠ¡åˆ°å…¶ä»–æ—¥æœŸï¼ˆéœ€åˆ é™¤åé‡å»ºï¼‰

### è®¾è®¡ç†ç”±

- æ—¥å†ä¸“æ³¨äºæ—¶é—´å—ç®¡ç†
- è·¨è§†å›¾æ‹–æ‹½ä¿æŒå•å‘æ€§ï¼ˆä»»åŠ¡åˆ—è¡¨ â†’ æ—¥å†ï¼‰
- æ”¹æœŸæ“ä½œç»Ÿä¸€é€šè¿‡ä»»åŠ¡åˆ—è¡¨å®Œæˆ

---

## ä»»åŠ¡æ’åºè§„åˆ™

### è§†å›¾å†…æ’åº

**æ’åºæœºåˆ¶**ï¼š

- åŒä¸€è§†å›¾å†…ä»»åŠ¡**æ— å›ºå®šæ’åºç®—æ³•**
- æ”¯æŒç”¨æˆ·ä»»æ„æ‹–æ‹½è°ƒæ•´é¡ºåº
- é¡ºåºé€šè¿‡ `view_preferences` è¡¨æŒä¹…åŒ–
- ä½¿ç”¨ `context_key` ä½œä¸ºä¸»é”®å­˜å‚¨æ’åº

**æ’åºå­˜å‚¨ç¤ºä¾‹**ï¼š

```javascript
// misc::staging è§†å›¾çš„æ’åº
context_key: 'misc::staging'
sorted_task_ids: '["uuid-1", "uuid-2", "uuid-3"]'

// daily::2025-10-01 è§†å›¾çš„æ’åº
context_key: 'daily::2025-10-01'
sorted_task_ids: '["uuid-4", "uuid-5"]'

// area::{uuid} è§†å›¾çš„æ’åº
context_key: 'area::a1b2c3d4-1234-5678-90ab-cdef12345678'
sorted_task_ids: '["uuid-6", "uuid-7"]'
```

**é‡æ’åŠŸèƒ½**ï¼š

- æä¾›"é‡æ–°æ’åº"æŒ‰é’®
- å¯æŒ‰åˆ›å»ºæ—¶é—´ã€ä¼˜å…ˆçº§ã€å­—æ¯é¡ºåºç­‰æ’åº
- æœªæ¥æ”¯æŒï¼ˆå¾…å®ç°ï¼‰

---

### æ–°ä»»åŠ¡æ’å…¥ä½ç½®

**å½“å‰è§„åˆ™**ï¼š

- æ–°åˆ›å»ºçš„ä»»åŠ¡å‡ºç°åœ¨**æ‰€æœ‰å·²å®Œæˆä»»åŠ¡ä¸Šé¢**
- å³ï¼šä½äºæœªå®Œæˆä»»åŠ¡åˆ—è¡¨çš„æœ«å°¾

**æœªæ¥é…ç½®**ï¼š

- é€šè¿‡è®¾ç½®æŒ‰é’®åˆ‡æ¢æ’å…¥ä½ç½®
- é€‰é¡¹ 1ï¼šå‡ºç°åœ¨åˆ—è¡¨æœ€ä¸‹é¢ï¼ˆé»˜è®¤ï¼‰
- é€‰é¡¹ 2ï¼šå‡ºç°åœ¨åˆ—è¡¨æœ€ä¸Šé¢

---

### å®Œæˆä»»åŠ¡æ—¶çš„æ’åºå˜åŒ–

**è§¦å‘æ—¶æœº**ï¼šç‚¹å‡»å®ŒæˆæŒ‰é’®ï¼ˆâœ“ï¼‰å®Œæˆä»»åŠ¡

**æ’åºè¡Œä¸º**ï¼š

1. å°†åˆšå®Œæˆçš„ä»»åŠ¡ç§»åˆ°**æ‰€æœ‰æœªå®Œæˆä»»åŠ¡ä¸‹é¢**
2. ä½äºå·²å®Œæˆä»»åŠ¡åŒºåŸŸçš„é¡¶éƒ¨
3. è¿™æ˜¯ä¸€æ¬¡æ€§è‡ªåŠ¨æ’åº

**åç»­æ“ä½œ**ï¼š

- ç”¨æˆ·ä»å¯æ‰‹åŠ¨æ‹–æ‹½åˆ°å…¶ä»–ä½ç½®
- è‡ªåŠ¨æ’åºä¸é”å®šä½ç½®

**ç¤ºä¾‹**ï¼š

```
å®Œæˆå‰ï¼š
  [ ] ä»»åŠ¡A
  [ ] ä»»åŠ¡B â† ç‚¹å‡»å®Œæˆ
  [ ] ä»»åŠ¡C
  [âœ“] ä»»åŠ¡Dï¼ˆå·²å®Œæˆï¼‰

å®Œæˆåï¼š
  [ ] ä»»åŠ¡A
  [ ] ä»»åŠ¡C
  [âœ“] ä»»åŠ¡B â† è‡ªåŠ¨ç§»åˆ°è¿™é‡Œ
  [âœ“] ä»»åŠ¡D
```

---

### è·¨è§†å›¾æ‹–æ‹½åçš„æ’åº

**è§„åˆ™**ï¼š

- æ‹–æ‹½åˆ°ç›®æ ‡è§†å›¾æ—¶ï¼Œæ’å…¥åˆ°ç”¨æˆ·æ‹–æ”¾çš„ä½ç½®
- é€šè¿‡ `view_preferences` è®°å½•è¯¥ä½ç½®
- é¿å…ä»»åŠ¡æ€»æ˜¯å‡ºç°åœ¨åº•éƒ¨

---

### âš ï¸ ç­›é€‰è§†å›¾çš„æ’åºé—®é¢˜

**åœºæ™¯æè¿°**ï¼š

- æŸäº›è§†å›¾æ˜¯åŸºäºç­›é€‰æ¡ä»¶åŠ¨æ€ç”Ÿæˆçš„
- å¦‚ `misc::staging::no-area`ã€`misc::staging::{area_uuid}`

**æ’åºç­–ç•¥**ï¼š

- æ¯ä¸ªç­›é€‰è§†å›¾æœ‰ç‹¬ç«‹çš„æ’åºé…ç½®
- ç­›é€‰è§†å›¾çš„æ’åºç‹¬ç«‹äºçˆ¶è§†å›¾
- æ’åºè°ƒæ•´åªå½±å“å½“å‰ç­›é€‰è§†å›¾

**ç¤ºä¾‹**ï¼š

```javascript
// å…¨éƒ¨ staging çš„æ’åº
context_key: 'misc::staging'
sorted_task_ids: '["uuid-1", "uuid-2", "uuid-3", "uuid-4"]'

// æ— åŒºåŸŸ staging çš„æ’åºï¼ˆç‹¬ç«‹ï¼‰
context_key: 'misc::staging::no-area'
sorted_task_ids: '["uuid-1", "uuid-3"]'

// æŒ‡å®šåŒºåŸŸ staging çš„æ’åºï¼ˆç‹¬ç«‹ï¼‰
context_key: 'misc::staging::a1b2c3d4-1234-5678-90ab-cdef12345678'
sorted_task_ids: '["uuid-2", "uuid-4"]'
```

---

## æ‹–æ‹½ç­–ç•¥çŸ©é˜µ

### æŒ‰æºè§†å›¾ç±»å‹

| æºè§†å›¾ç±»å‹ | â†’ æš‚å­˜è§†å›¾ | â†’ è¿‡å»æ—¥æœŸ | â†’ ä»Šæ—¥ | â†’ æœªæ¥æ—¥æœŸ | â†’ Area | â†’ Project |
| ---------- | ---------- | ---------- | ------ | ---------- | ------ | --------- |
| **æš‚å­˜**   | æ’åº       | è¡¥å½•å®Œæˆ   | æ’æœŸ   | æ’æœŸ       | è®¾åŒºåŸŸ | è®¾é¡¹ç›®    |
| **è¿‡å»**   | å–æ¶ˆæ’æœŸ   | æ’åº       | é‡æ’   | é‡æ’       | è®¾åŒºåŸŸ | è®¾é¡¹ç›®    |
| **ä»Šæ—¥**   | å–æ¶ˆæ’æœŸ   | âŒ æ‹’ç»    | æ’åº   | æ”¹æœŸ       | è®¾åŒºåŸŸ | è®¾é¡¹ç›®    |
| **æœªæ¥**   | å–æ¶ˆæ’æœŸ   | âŒ æ‹’ç»    | æå‰   | æ”¹æœŸ       | è®¾åŒºåŸŸ | è®¾é¡¹ç›®    |
| **Area**   | å–æ¶ˆæ’æœŸ   | è¡¥å½•å®Œæˆ   | æ’æœŸ   | æ’æœŸ       | æ’åº   | è®¾é¡¹ç›®    |
| **Project**| å–æ¶ˆæ’æœŸ   | è¡¥å½•å®Œæˆ   | æ’æœŸ   | æ’æœŸ       | è®¾åŒºåŸŸ | æ’åº      |
| **Upcoming** | å–æ¶ˆæ’æœŸ | âŒ æ‹’ç»   | æ”¹æœŸ   | æ”¹æœŸ       | è®¾åŒºåŸŸ | è®¾é¡¹ç›®    |

### å›¾ä¾‹è¯´æ˜

- **æ’åº**ï¼šä»…è°ƒæ•´é¡ºåºï¼Œä¸è§¦å‘ä¸šåŠ¡é€»è¾‘
- **æ’æœŸ**ï¼šåˆ›å»º scheduleï¼Œè§¦å‘ã€åˆ›å»ºæ—¥ç¨‹äº‹ä»¶ã€‘
- **æ”¹æœŸ**ï¼šåˆ é™¤æ—§ scheduleï¼Œåˆ›å»ºæ–° schedule
- **é‡æ’**ï¼šä¿ç•™æ—§ scheduleï¼Œåˆ›å»ºæ–° schedule
- **è¡¥å½•å®Œæˆ**ï¼šåˆ›å»º schedule + è‡ªåŠ¨æ ‡è®°å®Œæˆ
- **å–æ¶ˆæ’æœŸ**ï¼šè§¦å‘ã€å›åˆ°æš‚å­˜åŒºäº‹ä»¶ã€‘
- **è®¾åŒºåŸŸ**ï¼šè®¾ç½®ä»»åŠ¡çš„ area_id
- **è®¾é¡¹ç›®**ï¼šè®¾ç½®ä»»åŠ¡çš„ project_id
- **âŒ æ‹’ç»**ï¼šé™é»˜å¼¹å›ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œ

---

## âš ï¸ å¾…è¡¥å……ï¼šæœªå®šä¹‰æ‹–æ”¾è§„åˆ™çš„è§†å›¾

ä»¥ä¸‹è§†å›¾åœ¨ `VIEW_CONTEXT_KEY_SPEC.md` ä¸­å®šä¹‰ï¼Œä½†å°šæœªåœ¨æœ¬æ–‡æ¡£ä¸­æ˜ç¡®æ‹–æ”¾è§„åˆ™ã€‚

### Misc æ‚é¡¹è§†å›¾ï¼ˆ6ä¸ªï¼‰

| Context Key | è¯´æ˜ | å¾…å†³ç­– |
|-------------|------|--------|
| `misc::all` | æ‰€æœ‰ä»»åŠ¡ï¼ˆåŒ…æ‹¬å·²å®Œæˆï¼‰ | åªè¯»è§†å›¾ï¼Ÿæˆ–åŒé€šç”¨è§†å›¾è§„åˆ™ |
| `misc::planned` | å·²å®‰æ’çš„ä»»åŠ¡ | åŒæ—¥æœŸè§†å›¾è§„åˆ™ï¼ˆä»»åŠ¡å·²æœ‰æ’æœŸï¼‰ |
| `misc::incomplete` | æ‰€æœ‰æœªå®Œæˆä»»åŠ¡ | åŒé€šç”¨è§†å›¾è§„åˆ™ |
| `misc::completed` | å·²å®Œæˆä»»åŠ¡ | åªè¯»è§†å›¾ï¼Ÿæˆ–æ‹–å‡ºæ—¶è‡ªåŠ¨é‡å¼€ |
| `misc::deadline` | å³å°†åˆ°æœŸçš„ä»»åŠ¡ï¼ˆ7å¤©å†…ï¼‰ | åŒé€šç”¨è§†å›¾è§„åˆ™ |
| `misc::no-project` | æ— é¡¹ç›®ä»»åŠ¡æ±  | æ‹–å…¥=æ¸…é™¤ project_idï¼Ÿ |

### Template æ¨¡æ¿è§†å›¾ï¼ˆ1ä¸ªï¼‰

| Context Key | è¯´æ˜ | å¾…å†³ç­– |
|-------------|------|--------|
| `misc::template` | æ¨¡æ¿åˆ—è¡¨ | æ‹–åˆ°æ—¥æœŸè§†å›¾=ä»æ¨¡æ¿åˆ›å»ºä»»åŠ¡å®ä¾‹ï¼Ÿ |

### Daily æ—¥æœŸå­è§†å›¾ï¼ˆ2ä¸ªï¼‰

| Context Key | è¯´æ˜ | å¾…å†³ç­– |
|-------------|------|--------|
| `daily::{date}::incomplete` | æ¯æ—¥æœªå®Œæˆä»»åŠ¡ | åŒæ—¥æœŸè§†å›¾ï¼Œåªæ˜¯ç­›é€‰äº†æœªå®Œæˆ |
| `daily::{date}::completed` | æ¯æ—¥å·²å®Œæˆä»»åŠ¡ | åŒæ—¥æœŸè§†å›¾ï¼Œæ‹–å‡ºæ—¶è‡ªåŠ¨é‡å¼€ï¼Ÿ |

### Project ç« èŠ‚è§†å›¾ï¼ˆ2ä¸ªï¼‰

| Context Key | è¯´æ˜ | å¾…å†³ç­– |
|-------------|------|--------|
| `project::{uuid}::section::all` | é¡¹ç›®æœªåˆ†ç±»ä»»åŠ¡ | æ‹–å…¥=è®¾ project_id + æ¸…é™¤ section_id |
| `project::{uuid}::section::{sectionId}` | é¡¹ç›®ç‰¹å®šç« èŠ‚ | æ‹–å…¥=è®¾ project_id + section_id |

### å¤åˆç­›é€‰è§†å›¾ï¼ˆ2ä¸ªï¼Œæœªæ¥æ‰©å±•ï¼‰

| Context Key | è¯´æ˜ | å¾…å†³ç­– |
|-------------|------|--------|
| `daily::{date}::area::{uuid}` | æ—¥æœŸ+åŒºåŸŸ | æ‹–å…¥=æ’æœŸ+è®¾åŒºåŸŸ |
| `project::{uuid}::area::{uuid}` | é¡¹ç›®+åŒºåŸŸ | æ‹–å…¥=è®¾é¡¹ç›®+è®¾åŒºåŸŸ |

### å…³é”®å†³ç­–ç‚¹

1. **`misc::template`** çš„æ‹–æ”¾æ˜¯å¦è§¦å‘"ä»æ¨¡æ¿åˆ›å»ºä»»åŠ¡"ï¼Ÿ
2. **`misc::completed`** å’Œ **`daily::{date}::completed`** æ‹–å‡ºæ˜¯å¦è‡ªåŠ¨é‡å¼€ä»»åŠ¡ï¼Ÿ
3. **`misc::all`**ã€**`misc::incomplete`** ç­‰æ˜¯å¦å…è®¸æ‹–æ”¾ï¼Œè¿˜æ˜¯åªè¯»è§†å›¾ï¼Ÿ
4. **`misc::no-project`** æ‹–å…¥æ˜¯å¦æ¸…é™¤ project_idï¼Ÿ

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv2.1
**æœ€åæ›´æ–°**ï¼š2025-11-27
**å˜æ›´è¯´æ˜**ï¼š

- v2.1: æ–°å¢"å¾…è¡¥å……"ç« èŠ‚ï¼Œåˆ—å‡ºå°šæœªå®šä¹‰æ‹–æ”¾è§„åˆ™çš„ 13 ç§è§†å›¾
- v2.0: é‡æ„æ–‡æ¡£ï¼Œä»"çœ‹æ¿"æŠ½è±¡åˆ°"è§†å›¾"å±‚é¢ï¼Œå¢åŠ  Context Key å…³è”ï¼Œæ–°å¢é€šç”¨è§†å›¾æ‹–æ‹½è§„åˆ™å’Œæ‹–æ‹½ç­–ç•¥çŸ©é˜µ
- v1.0: ä»ã€Šä¸šåŠ¡é€»è¾‘.mdã€‹æ‹†åˆ†ï¼ŒåŒ…å«çœ‹æ¿æ‹–æ‹½è§„åˆ™å’Œä»»åŠ¡æ’åºè§„åˆ™
