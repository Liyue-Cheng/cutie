# Cutie æ ¸å¿ƒæ¦‚å¿µé€ŸæŸ¥è¡¨

> "å¹³é™å·¥ä½œ"ç†å¿µçš„ç»ˆæè¯ é‡Š - ä¸ºä¸ªäººæ‰“é€ çš„å®é™æ•°å­—ç©ºé—´

---

## ğŸ“– æ ¸å¿ƒå“²å­¦

### è®¾è®¡åŸåˆ™

1. **æœ€å°åŒ–å…ƒå·¥ä½œ** - å‡å°‘ç®¡ç†å·¥å…·æœ¬èº«çš„å·¥ä½œ
2. **è¿‡ç¨‹ä¼˜äºç»“æœ** - è®¤å¯åŠªåŠ›ï¼Œè€Œéåªå…³æ³¨å®Œæˆ
3. **è‡ªä¸»æƒè‡³ä¸Š** - AIè¾…åŠ©ä½†ä¸å†³ç­–ï¼Œç”¨æˆ·æ°¸è¿œæ˜¯å¯¼æ¼”
4. **ä¸ªäººç©ºé—´ç¥åœ£** - æ‹’ç»å›¢é˜Ÿåä½œï¼Œä¿æŠ¤ç§å¯†æ€§
5. **æ¥çº³å˜åŒ–** - è®¡åˆ’æ”¹å˜æ˜¯å¸¸æ€ï¼Œé€¾æœŸä¸æ˜¯å¤±è´¥

---

## ğŸ—ï¸ æ ¸å¿ƒæ¶æ„

### 1. æ•°æ®æ¨¡å‹ï¼šä»»åŠ¡ä¸æ—¶é—´ç‰‡å¤šå¯¹å¤šè¿æ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Task   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ task_time_block_linksâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ TimeBlock  â”‚
â”‚ (ä»»åŠ¡)  â”‚   N : M   â”‚    (é“¾æ¥è¡¨)          â”‚   N : M   â”‚  (æ—¶é—´ç‰‡)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‰¹æ€§ï¼š**

- âœ… ä¸€ä¸ªæ—¶é—´ç‰‡å¯ä»¥åŒ…å«å¤šä¸ªä»»åŠ¡ï¼ˆä¸»é¢˜å¼è§„åˆ’ï¼‰
- âœ… ä¸€ä¸ªä»»åŠ¡å¯ä»¥åˆ†æ•£åœ¨å¤šä¸ªæ—¶é—´ç‰‡ä¸­ï¼ˆåˆ†æ®µæ‰§è¡Œï¼‰
- âš ï¸ **æ—¶é—´ç‰‡ä¸èƒ½é‡å **ï¼ˆç°å®ä¸»ä¹‰çº¦æŸï¼‰

**ä¸ä¼ ç»Ÿå·¥å…·çš„åŒºåˆ«ï¼š**

```
âŒ Sunsama: Task â†â†’ TimeBlock (ä¸€å¯¹ä¸€/ä¸€å¯¹å¤šï¼Œä»¥ä»»åŠ¡ä¸ºä¸­å¿ƒ)
âœ… Cutie:   Task â†â†’ TimeBlock (å¤šå¯¹å¤šï¼Œä»¥æ—¶é—´å—ä¸»é¢˜ä¸ºä¸­å¿ƒ)
```

---

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„ï¼ˆå…³é”®è¡¨ï¼‰

### æ ¸å¿ƒè¡¨åæ¸…å•

| å®ä½“     | è¡¨å                    | å•/å¤æ•°  | âš ï¸ æ³¨æ„äº‹é¡¹           |
| -------- | ----------------------- | -------- | --------------------- |
| ä»»åŠ¡     | `tasks`                 | å¤æ•°     | -                     |
| æ—¶é—´å—   | `time_blocks`           | å¤æ•°     | start_time < end_time |
| æ—¥ç¨‹     | `task_schedules`        | å¤æ•°     | ä»»åŠ¡åœ¨æŸå¤©çš„å®‰æ’      |
| æ’åº     | `orderings`             | **å•æ•°** | lexorank              |
| åŒºåŸŸ     | `areas`                 | å¤æ•°     | å†³å®šæŸ“è‰²              |
| é¡¹ç›®     | `projects`              | å¤æ•°     | -                     |
| æ¨¡æ¿     | `templates`             | å¤æ•°     | å¿«é€Ÿåˆ›å»ºä»ªå¼/æµç¨‹     |
| ä»»åŠ¡é“¾æ¥ | `task_time_block_links` | å¤æ•°     | å¤šå¯¹å¤šä¸­é—´è¡¨          |

**æ³¨æ„ï¼šæ‰€æœ‰è¡¨åç»Ÿä¸€ä½¿ç”¨å¤æ•°å½¢å¼**

---

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µå®šä¹‰

### 1. Stagingï¼ˆæš‚å­˜åŒºï¼‰

**å®šä¹‰ï¼š** æœªå®‰æ’åˆ°å…·ä½“æ—¥æœŸçš„ä»»åŠ¡çš„é›†åˆ

**ç‰¹æ€§ï¼š**

- âœ… æ›¿ä»£ä¼ ç»Ÿçš„ Backlog/Inbox
- âœ… é€¾æœŸä»»åŠ¡è‡ªåŠ¨å›æµåˆ°æ­¤å¤„ï¼ˆæ— çº¢è‰²æ ‡ç­¾ï¼Œæ— è´Ÿç½ªæ„Ÿï¼‰
- âœ… æ–°ä»»åŠ¡é»˜è®¤åˆ›å»ºåœ¨æ­¤å¤„
- âœ… é€šè¿‡é¡¹ç›®è¿‡æ»¤ï¼š`staging` (å…¨éƒ¨) / `staging-($project_xxx)`ï¼ˆæŒ‰é¡¹ç›®ï¼‰

**å“²å­¦ï¼š**

```
Backlog = "ç§¯å‹çš„å·¥ä½œå€ºåŠ¡"ï¼ˆè´Ÿé¢ï¼‰
Staging = "ç­‰å¾…è°ƒåº¦çš„èµ„æº"ï¼ˆä¸­æ€§/æ­£é¢ï¼‰
```

**æ•°æ®å®ç°ï¼š**

```sql
-- Staging ä»»åŠ¡çš„åˆ¤æ–­æ¡ä»¶
WHERE is_deleted = false
  AND completed_at IS NULL
  AND NOT EXISTS (SELECT 1 FROM task_schedules WHERE task_id = tasks.id)
```

---

### 2. Presenceï¼ˆå­˜åœ¨/åœ¨åœºï¼‰

**å®šä¹‰ï¼š** è®°å½•ä½ å·²ç»ä¸ºæŸä¸ªæ—¶é—´ç‰‡ä»˜å‡ºäº†è®¡åˆ’çš„æ—¶é—´ï¼Œæ— è®ºä»»åŠ¡æ˜¯å¦å®Œæˆ

**ä½¿ç”¨åœºæ™¯ï¼š**

- ä½ è®¡åˆ’2å°æ—¶é‡è£…ç³»ç»Ÿï¼Œå®é™…åšäº†2å°æ—¶ä½†æœªå®Œæˆ
- ç‚¹å‡» Presenceï¼Œæ—¶é—´ç‰‡è¢«é”å®šåœ¨ä»Šå¤©çš„æ—¥å†ä¸Š
- ä»»åŠ¡å›åˆ° Stagingï¼Œç­‰å¾…é‡æ–°å®‰æ’

**ä¸ä¼ ç»Ÿå®Œæˆçš„åŒºåˆ«ï¼š**

```
å®Œæˆ (Complete):
  - ä»»åŠ¡ is_completed = true
  - æ—¶é—´ç‰‡ä¿ç•™
  - ä»»åŠ¡ä»æ‰€æœ‰è§†å›¾æ¶ˆå¤±

Presence:
  - ä»»åŠ¡ is_completed = false
  - æ—¶é—´ç‰‡é”å®šï¼ˆè®°å½•åŠªåŠ›ï¼‰
  - ä»»åŠ¡å›åˆ° Stagingï¼ˆç­‰å¾…é‡æ–°å®‰æ’ï¼‰
```

**Project/Experience çš„ç‰¹æ®Šè§„åˆ™ï¼š**

- é»˜è®¤æŒ‰é’®æ˜¯ Presenceï¼ˆå› ä¸ºè¿™ç±»å·¥ä½œæ— æ˜ç¡®ç»ˆç‚¹ï¼‰
- å®Œæˆéœ€è¦è¿›å…¥è¯¦æƒ…é¡µé¢æ‰‹åŠ¨æ ‡è®°

**æ•°æ®å®ç°ï¼š**

```sql
-- task_schedules è¡¨ä¸­çš„ outcome å­—æ®µ
outcome: 'PLANNED' | 'PRESENCE_LOGGED' | 'COMPLETED' | 'CARRIED_OVER'

-- Presence = PRESENCE_LOGGED
UPDATE task_schedules SET outcome = 'PRESENCE_LOGGED' WHERE ...
```

---

### 3. Areaï¼ˆåŒºåŸŸï¼‰

**å®šä¹‰ï¼š** ä»»åŠ¡çš„è¯­ä¹‰åˆ†ç±»ï¼Œå†³å®šæŸ“è‰²

**ç‰¹æ€§ï¼š**

- âœ… AI è‡ªåŠ¨åˆ†é…ï¼ˆå…¨è‡ªåŠ¨ï¼Œæ— éœ€äººå·¥å¹²é¢„ï¼‰
- âœ… æ¯ä¸ª Area æœ‰é¢œè‰²å±æ€§
- âœ… æ—¶é—´ç‰‡å’Œä»»åŠ¡éƒ½å¯ä»¥æœ‰ Area

**AI è‡ªåŠ¨åˆ†é…ç¤ºä¾‹ï¼š**

```
"ä¿®å¤ç™»å½•bug" â†’ å¼€å‘ Area (è“è‰²)
"å›¢é˜Ÿå‘¨ä¼š" â†’ åä½œ Area (ç»¿è‰²)
"å†™æ—¥è®°" â†’ ä¸ªäºº Area (ç´«è‰²)
```

---

### 4. Templateï¼ˆæ¨¡æ¿ï¼‰

**å®šä¹‰ï¼š** é¢„è®¾çš„ä»»åŠ¡åºåˆ—æˆ–ä»ªå¼æµç¨‹

**åº”ç”¨åœºæ™¯ï¼š**

- âœ… æ—©æ™¨å¯åŠ¨ä»ªå¼ï¼šå–æ°´ â†’ å†¥æƒ³10åˆ†é’Ÿ â†’ è§„åˆ’ä¸€å¤©
- âœ… Daily Shutdown è‡ªå®šä¹‰ä»ªå¼ï¼šå¬æ­Œ â†’ å†¥æƒ³ â†’ å…³æ‰‹æœº
- âœ… å°ç¡®å¹¸ä»ªå¼ï¼šæ³¡èŒ¶ â†’ çœ‹å‰§ â†’ æ•£æ­¥
- âœ… æ¯å‘¨å¤ç›˜æµç¨‹ï¼šå›é¡¾ â†’ æ•´ç† â†’ è§„åˆ’

**æ“ä½œï¼š**

- æ‹–åˆ° Stagingï¼šåˆ›å»ºä¸ºæœªå®‰æ’çš„ä»»åŠ¡
- æ‹–åˆ° Timelineï¼šç›´æ¥åˆ›å»ºä¸ºæ—¶é—´å—

---

### 5. å­ä»»åŠ¡ (Subtasks)

**æ ¸å¿ƒç›®æ ‡ï¼š** å¸®åŠ©å¯åŠ¨ï¼Œè€Œéç»“æ„æ‹†è§£

**AI ç”Ÿæˆé£æ ¼ï¼š**

- é»˜è®¤ï¼š"å°‘å¥³çš„çµ®è¯­"ï¼ˆ10å­—ä»¥å†…ï¼Œæ¸©æŸ”é¼“åŠ±ï¼‰
- å¯è‡ªå®šä¹‰æç¤ºè¯ï¼ˆå¥èº«æ•™ç»ƒ/JRPG/èˆ¹é•¿å‘½ä»¤ç­‰ï¼‰

**ç¤ºä¾‹ï¼š**

```
ä»»åŠ¡: "æ‰“æ‰«æˆ¿é—´"

ä¼ ç»Ÿå­ä»»åŠ¡:
1. æ”¶æ‹¾æ¡Œé¢
2. æ‰«åœ°
3. æ‹–åœ°

Cutie å­ä»»åŠ¡ï¼ˆå°‘å¥³çµ®è¯­ï¼‰:
1. å…ˆæŠŠæ¡Œä¸Šçš„å°å¯çˆ±ä»¬æ‘†å¥½å§ï½
2. è®©åœ°é¢å˜å¾—å…‰æ´å¦‚æ–°å“¦ï¼
3. å’Œç°å°˜è¯´æ‹œæ‹œå•¦ï¼
```

---

### 6. VLM æˆªå›¾å¯¼å…¥

**å®šä¹‰ï¼š** é€šè¿‡è§†è§‰è¯­è¨€æ¨¡å‹è¯†åˆ«æˆªå›¾ä¸­çš„ä»»åŠ¡ä¿¡æ¯

**å·¥ä½œæµï¼š**

```
1. çœ‹åˆ°ä»»ä½•ç•Œé¢çš„å¾…åŠäº‹é¡¹
2. æŒ‰å¿«æ·é”® â†’ æ¡†é€‰æˆªå›¾
3. VLM åˆ†æ â†’ æå–ä»»åŠ¡å†…å®¹ã€æˆªæ­¢æ—¥æœŸã€ä¸Šä¸‹æ–‡
4. é¢„å¡«ä»»åŠ¡åˆ›å»ºæ¡† â†’ ç¡®è®¤ â†’ è¿›å…¥ Staging
```

**è¦†ç›–èŒƒå›´ï¼š**

- âœ… é‚®ä»¶ã€Slackã€GitHubã€å¾®ä¿¡ã€æ‰‹å†™ç¬”è®°...
- âœ… ä»»ä½•å±å¹•ä¸Šå¯è§çš„å†…å®¹
- âœ… **é™ç»´æ‰“å‡»ä¼ ç»Ÿ API é›†æˆ**

---

## ğŸ¤– AI ç³»ç»Ÿæ¶æ„

### AI çš„èŒè´£è¾¹ç•Œ

| AI å¯ä»¥åš                       | AI ä¸èƒ½åš             |
| ------------------------------- | --------------------- |
| âœ… è‡ªåŠ¨åˆ†é… Area                | âŒ å†³å®šä»»åŠ¡ä½•æ—¶æ‰§è¡Œ   |
| âœ… æ•´ç† Stagingï¼ˆå»ºè®®é¡¹ç›®åˆ†ç»„ï¼‰ | âŒ è‡ªåŠ¨å®‰æ’åˆ°æ—¥å†     |
| âœ… ç”Ÿæˆå­ä»»åŠ¡                   | âŒ ä¿®æ”¹ç”¨æˆ·çš„æ—¶é—´åˆ†é… |
| âœ… VLM è¯†åˆ«ä»»åŠ¡ä¿¡æ¯             | âŒ æ›¿ç”¨æˆ·åšä»»ä½•å†³ç­–   |
| âœ… æä¾›å»ºè®®ï¼ˆéœ€ç”¨æˆ·ç¡®è®¤ï¼‰       | âŒ è¯„åˆ¤ç”¨æˆ·çš„å·¥ä½œæ•ˆç‡ |

### AI é…ç½®

```
ç”¨æˆ·è‡ªå¡« API ç«¯ç‚¹ï¼ˆBYOK - Bring Your Own Keyï¼‰
- æ”¯æŒï¼šOpenAI, Claude, Gemini, æœ¬åœ°æ¨¡å‹ç­‰
- å¥½å¤„ï¼šæˆæœ¬é€æ˜ã€éšç§å¯æ§ã€æ°¸è¿œæœ€æ–°
```

---

## ğŸ­ æ ¸å¿ƒå·¥ä½œæµ

### ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VLMæˆªå›¾å¯¼å…¥  â”‚
â”‚  æˆ–æ‰‹åŠ¨åˆ›å»º   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     AIè‡ªåŠ¨     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Staging    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ åˆ†é…Area â”‚
â”‚   (æš‚å­˜åŒº)   â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ ç”¨æˆ·æ‰‹åŠ¨æ‹–æ‹½
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Timeline    â”‚
â”‚  (æ—¶é—´çº¿)    â”‚
â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚TimeBlockâ”‚ â”‚ â†â”€â”€ å¯åŒ…å«å¤šä¸ªä»»åŠ¡
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â†’ å®Œæˆ (Complete) â†’ ä»»åŠ¡æ¶ˆå¤±
       â”‚
       â””â”€â†’ Presence â†’ æ—¶é—´ç‰‡é”å®š + ä»»åŠ¡å›åˆ° Staging
```

### æ¯æ—¥æµç¨‹

```
ğŸŒ… æ—©æ™¨
  â”œâ”€ æ‰§è¡Œ"æ—©æ™¨å¯åŠ¨"æ¨¡æ¿
  â”œâ”€ æŸ¥çœ‹ Staging
  â”œâ”€ AI å»ºè®®æ•´ç†é¡¹ç›®ï¼ˆå¯é€‰ï¼‰
  â””â”€ æ‰‹åŠ¨æ‹–æ‹½ä»»åŠ¡åˆ° Timeline

ğŸŒ ç™½å¤©
  â”œâ”€ æ‰§è¡Œæ—¶é—´å—ä¸­çš„ä»»åŠ¡
  â”œâ”€ ç‚¹å‡» Presence/Complete
  â””â”€ çµæ´»è°ƒæ•´ï¼ˆä»»åŠ¡å¯åœ¨å¤šä¸ªæ—¶é—´å—ï¼‰

ğŸŒ™ æ™šä¸Š
  â”œâ”€ æ‰§è¡Œè‡ªå®šä¹‰ Shutdown ä»ªå¼
  â”‚  â””â”€ å¬æ­Œ/å†¥æƒ³/å…³æ‰‹æœºç­‰
  â””â”€ æœªå®Œæˆä»»åŠ¡è‡ªåŠ¨å›åˆ° Staging
```

---

## ğŸš« Cutie çš„æˆ˜ç•¥æ€§å¦¥å

### 1. ä¸åšå›¢é˜Ÿåä½œ

```
åŸå› ï¼šä¿æŠ¤ä¸ªäººç©ºé—´çš„çº¯ç²¹æ€§
ç»“æœï¼šCutie æ˜¯ä½ çš„ç§äººé¿éš¾æ‰€ï¼Œä¸æ˜¯å·¥ä½œåœºæ‰€
å®šä½ï¼šä¸å›¢é˜Ÿå·¥å…·äº’è¡¥ï¼Œè€Œéç«äº‰
```

### 2. ä¸åšæ•°æ®åˆ†æ

```
åŸå› ï¼šé¿å…"æ•°æ®ç®¡ç†"è¿™ä¸€å·¨å¤§çš„å…ƒå·¥ä½œ
ç»“æœï¼šæ´»åœ¨å½“ä¸‹ï¼Œè€Œéæ´»åœ¨å›¾è¡¨é‡Œ
å“²å­¦ï¼šæ„Ÿå—é©±åŠ¨çš„è§„åˆ’ > æ•°æ®é©±åŠ¨çš„é‡åŒ–
```

---

## ğŸ¨ å‰ç«¯æ•°æ®æ¨¡å‹ (DTOs)

### TaskCardï¼ˆä»»åŠ¡å¡ç‰‡ - ç”¨äºçœ‹æ¿ï¼‰

```typescript
interface TaskCard {
  // æ ¸å¿ƒèº«ä»½
  id: string
  title: string
  glance_note: string | null
  sort_order: string // LexoRank

  // æ ¸å¿ƒçŠ¶æ€
  is_completed: boolean
  schedule_status: 'scheduled' | 'staging'

  // ä¸Šä¸‹æ–‡ä¿¡æ¯
  area: { id; name; color } | null
  project_id: string | null
  subtasks: Array<{ id; title; is_completed; sort_order }> | null

  // æ—¥ç¨‹ä¿¡æ¯
  schedule_info: {
    outcome_for_today: 'planned' | 'presence_logged' | 'completed' | 'carried_over' | null
    is_recurring: boolean
    linked_schedule_count: number
  } | null

  // æˆªæ­¢æ—¥æœŸ
  due_date: { date; type: 'soft' | 'hard'; is_overdue } | null

  // UI æç¤º
  has_detail_note: boolean
}
```

### TaskDetailï¼ˆä»»åŠ¡è¯¦æƒ… - ç”¨äºç¼–è¾‘ï¼‰

```typescript
interface TaskDetail extends TaskCard {
  detail_note: string | null
  schedules: Array<{ day; outcome }>
  project: { id; name } | null
  created_at: string
  updated_at: string
}
```

### TimeBlockViewï¼ˆæ—¶é—´å—è§†å›¾ - ç”¨äºæ—¥å†ï¼‰

```typescript
interface TimeBlockView {
  id: string
  start_time: string // ISO 8601 UTC
  end_time: string // ISO 8601 UTC

  title: string | null
  glance_note: string | null
  detail_note: string | null

  area: { id; name; color } | null

  linked_tasks: Array<{
    // åŒ…å«çš„ä»»åŠ¡æ‘˜è¦
    id: string
    title: string
    is_completed: boolean
  }>

  is_recurring: boolean
}
```

---

## ğŸ”‘ å…³é”®æ¦‚å¿µå¯¹ç…§è¡¨

| Cutie æ¦‚å¿µ    | ä¼ ç»Ÿæ¦‚å¿µ      | æ ¸å¿ƒåŒºåˆ«                       |
| ------------- | ------------- | ------------------------------ |
| Staging       | Backlog/Inbox | ä¸­æ€§çš„å‡†å¤‡åŒº vs æ¶ˆæçš„ç§¯å‹åŒº   |
| Presence      | Complete      | è®°å½•åŠªåŠ› vs åªå…³æ³¨ç»“æœ         |
| Area (AIè‡ªåŠ¨) | Tag (æ‰‹åŠ¨)    | é›¶å…ƒå·¥ä½œ vs éœ€è¦ç®¡ç†           |
| VLMæˆªå›¾å¯¼å…¥   | APIé›†æˆ       | ä¸‡ç‰©çš†å¯æ•æ‰ vs æœ‰é™çš„å·¥å…·æ”¯æŒ |
| ç–—æ„ˆå¼å­ä»»åŠ¡  | ç»“æ„åŒ–å­ä»»åŠ¡  | é™ä½å¯åŠ¨é—¨æ§› vs ç†æ€§æ‹†è§£       |
| æ—¶é—´ç‰‡ä¸»é¢˜    | ä»»åŠ¡æ—¶é—´ç›’    | å®è§‚è§„åˆ’ vs å¾®è§‚åˆ†é…           |
| è‡ªå®šä¹‰ä»ªå¼    | æ¯æ—¥æ€»ç»“      | ç”Ÿæ´»çš„å¼€å¯ vs å·¥ä½œçš„æ”¶å°¾       |

---

## ğŸ’¾ æ•°æ®å±‚æ¶æ„

### å‰ç«¯ Store èŒè´£åˆ†ç¦»

```typescript
// TaskStore - ä»»åŠ¡åŸå§‹æ•°æ® CRUD
const tasks = new Map<string, TaskCard | TaskDetail>()  // å•ä¸€æ•°æ®æº
getters: stagingTasks, completedTasks, scheduledTasks
actions: create, update, delete, complete, reopen

// ViewStore - è§†å›¾ç´¢å¼•ç®¡ç†
const dailyTaskIds = new Map<string, string[]>()  // æ—¥æœŸ â†’ ä»»åŠ¡IDåˆ—è¡¨
getters: getDailyTasks(date), getDailyStats(date)
actions: fetchDailyTasks, scheduleTask, rescheduleTask

// TimeBlockStore - æ—¶é—´å—ç®¡ç†
const timeBlocks = new Map<string, TimeBlockView>()
getters: getTimeBlocksForDate, getTimeBlocksInRange
actions: create, update, delete, linkTask, unlinkTask
```

**åŸåˆ™ï¼š**

- State åªå­˜å‚¨åŸå§‹æ•°æ®
- Actions è´Ÿè´£ API è°ƒç”¨å’Œä¿®æ”¹ State
- Getters åªè¯»å–å’Œè®¡ç®—ï¼Œä¸ä¿®æ”¹

---

## ğŸ› ï¸ åç«¯æ¶æ„

### SFCï¼ˆå•æ–‡ä»¶ç»„ä»¶ï¼‰æ¨¡å¼

```
features/
â”œâ”€â”€ tasks/
â”‚   â”œâ”€â”€ endpoints/         # æ¯ä¸ªæ–‡ä»¶æ˜¯å®Œæ•´çš„åŠŸèƒ½å•å…ƒ
â”‚   â”‚   â”œâ”€â”€ create_task.rs
â”‚   â”‚   â”œâ”€â”€ get_task.rs
â”‚   â”‚   â””â”€â”€ legacy.rs      # complete_task ç¤ºä¾‹
â”‚   â”œâ”€â”€ shared/
â”‚   â”‚   â””â”€â”€ assembler.rs   # TaskAssembler (å®ä½“â†’DTOè½¬æ¢)
â”‚   â””â”€â”€ mod.rs             # è·¯ç”±æ³¨å†Œ
â”‚
â””â”€â”€ views/
    â”œâ”€â”€ endpoints/
    â”‚   â””â”€â”€ get_staging_view.rs
    â””â”€â”€ mod.rs
```

### è£…é…å™¨æ¨¡å¼

```rust
// âŒ é”™è¯¯ï¼šåœ¨ entities å±‚å†™è½¬æ¢é€»è¾‘
impl TaskCardDto {
    fn from(task: &Task) -> Self { ... }  // ä¸šåŠ¡é€»è¾‘ä¸å±äºè¿™é‡Œï¼
}

// âœ… æ­£ç¡®ï¼šåœ¨ features/shared ä¸­ä½¿ç”¨è£…é…å™¨
pub struct TaskAssembler;
impl TaskAssembler {
    pub fn task_to_card_basic(task: &Task) -> TaskCardDto { ... }
}
```

---

## âš ï¸ å¼€å‘è€…å¿…è¯»

### å¼ºåˆ¶æ€§æ£€æŸ¥æ¸…å•

åœ¨ç¼–å†™ä»»ä½•ä»£ç å‰ï¼š

- [ ] **æŸ¥çœ‹äº†æ•°æ®åº“ schemaï¼Ÿ**ï¼ˆ`migrations/xxx.sql`ï¼‰
- [ ] è¡¨åæ˜¯å¦æ­£ç¡®ï¼Ÿï¼ˆ`ordering` æ˜¯å•æ•°ï¼ï¼‰
- [ ] ä½¿ç”¨äº†æ­£ç¡®çš„ trait æ–¹æ³•ï¼Ÿ
  - `app_state.id_generator().new_uuid()` âœ…
  - `app_state.clock().now_utc()` âœ…
- [ ] æ’åºä½¿ç”¨äº† LexoRank å·¥å…·ï¼Ÿ
  - `generate_initial_sort_order()`
  - `get_rank_after(prev)`
  - `get_mid_lexo_rank(prev, next)`
- [ ] å¤ç”¨äº† `shared/` ä¸­çš„å·¥å…·ï¼Ÿ
- [ ] è£…é…å™¨åœ¨ `features/shared/` ä¸­ï¼Œä¸åœ¨ `entities/` ä¸­ï¼Ÿ

### æ ¸å¿ƒ API ç«¯ç‚¹ï¼ˆå·²å®ç°ï¼‰

| ç«¯ç‚¹                        | æ–¹æ³• | ç”¨é€”           |
| --------------------------- | ---- | -------------- |
| `/api/views/staging`        | GET  | è·å–æœªæ’æœŸä»»åŠ¡ |
| `/api/tasks`                | POST | åˆ›å»ºä»»åŠ¡       |
| `/api/tasks/:id/completion` | POST | å®Œæˆä»»åŠ¡       |

---

## ğŸ¯ è®¾è®¡å†³ç­–å¯¹ç…§

### Cutie vs Sunsama æ ¸å¿ƒå·®å¼‚

| ç»´åº¦         | Sunsama                  | Cutie                    |
| ------------ | ------------------------ | ------------------------ |
| **ç›®æ ‡ç”¨æˆ·** | ä¸“ä¸šäººå£« + å›¢é˜Ÿ          | **ä¸ªäººç”¨æˆ·**             |
| **é€¾æœŸå¤„ç†** | çº¢è‰²æ ‡ç­¾ï¼ˆè´Ÿç½ªæ„Ÿï¼‰       | **å›åˆ° Stagingï¼ˆæ¥çº³ï¼‰** |
| **æ—¶é—´æ¨¡å‹** | ä»»åŠ¡æ—¶é—´ç›’               | **æ—¶é—´å— + ä»»åŠ¡å¤šå¯¹å¤š**  |
| **åŠªåŠ›è®°å½•** | æ—                        | **Presence æŒ‰é’®**        |
| **é›†æˆæ–¹å¼** | API é›†æˆ                 | **VLM æˆªå›¾ï¼ˆä¸‡ç‰©çš†å¯ï¼‰** |
| **å­ä»»åŠ¡**   | ç»“æ„åŒ–æ‹†è§£               | **ç–—æ„ˆå¼å¯åŠ¨**           |
| **Shutdown** | å·¥ä½œæ€»ç»“                 | **ç”Ÿæ´»ä»ªå¼**             |
| **AI è§’è‰²**  | æ™ºèƒ½åŠ©ç†ï¼ˆå¯èƒ½åŒ…åŠä¸€åˆ‡ï¼‰ | **æ²‰é»˜ç®¡å®¶ + ç”¨æˆ·å¯¼æ¼”**  |
| **å›¢é˜Ÿåä½œ** | âœ… æ ¸å¿ƒåŠŸèƒ½              | âŒ **æˆ˜ç•¥æ€§æ”¾å¼ƒ**        |
| **æ•°æ®åˆ†æ** | âœ… è¯¦å°½å›¾è¡¨              | âŒ **æˆ˜ç•¥æ€§æ”¾å¼ƒ**        |

---

## ğŸŒŸ Cutie çš„æŠ¤åŸæ²³

1. **å“²å­¦æŠ¤åŸæ²³** - "å¹³é™"çš„æœ€çº¯ç²¹è¯ é‡Š
2. **æƒ…æ„ŸæŠ¤åŸæ²³** - æ¸©æš–ã€ç–—æ„ˆçš„ç”¨æˆ·ä½“éªŒ
3. **å®šä½æŠ¤åŸæ²³** - ä¸ªäººç©ºé—´çš„å”¯ä¸€æ€§
4. **å¼€æºæŠ¤åŸæ²³** - ç¤¾åŒºé©±åŠ¨ï¼ŒBYOK æ¨¡å¼

---

## ğŸ“ å‘½åçº¦å®š

### åç«¯ï¼ˆRustï¼‰

- è¡¨åï¼šå‚è€ƒ schemaï¼ˆ`ordering` æ˜¯å•æ•°ï¼ï¼‰
- å®ä½“ï¼š`Task`, `TimeBlock`, `Area`
- DTOï¼š`TaskCardDto`, `TaskDetailDto`, `TimeBlockViewDto`
- è¯·æ±‚ï¼š`CreateTaskRequest`, `UpdateTaskRequest`

### å‰ç«¯ï¼ˆTypeScriptï¼‰

- DTOï¼š`TaskCard`, `TaskDetail`, `TimeBlockView`
- Storeï¼š`useTaskStore`, `useViewStore`, `useTimeBlockStore`
- Payloadï¼š`CreateTaskPayload`, `UpdateTaskPayload`

---

## ğŸ“ æ ¸å¿ƒä»·å€¼è§‚

> "Cutie ä¸å¸®ä½ å˜æˆæ›´é«˜æ•ˆçš„æœºå™¨ï¼Œ
> è€Œæ˜¯è®©ä½ åœ¨æ··ä¹±ä¸­ä¿æŒä»å®¹ï¼Œ
> åœ¨å¿™ç¢Œä¸­æ‰¾åˆ°èŠ‚å¥ï¼Œ
> åœ¨ä»»åŠ¡å®Œæˆä¸å¦ä¹‹å¤–ï¼Œ
> çœ‹è§è‡ªå·±çš„åŠªåŠ›å’Œå­˜åœ¨ã€‚"

**è¿™ä¸æ˜¯ä¸€ä¸ªä»»åŠ¡ç®¡ç†å·¥å…·ï¼Œè¿™æ˜¯ä¸€ä¸ªäººç”Ÿä¼™ä¼´ã€‚**
